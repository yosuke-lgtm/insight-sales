<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>AI Sales OS</title>
  <style>
    /* Base Styles */
    :root {
      --sidebar-width: 220px;
      --primary-bg: #F3F4F6;
      --card-bg: #FFFFFF;
      --text-main: #111827;
      --text-sub: #6B7280;
      --accent: #2563EB;
      --border: #E5E7EB;
      --success: #10B981;
      --warning: #F59E0B;
      --danger: #EF4444;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0; /* Reset padding for full layout */
      background-color: var(--primary-bg);
      color: var(--text-main);
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }

    /* Input Controls Section (Sidepanel Only) */
    #controls {
      padding: 16px;
      background: white;
      border-bottom: 1px solid #ddd;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    /* Report Layout */
    .report-container {
      display: grid;
      grid-template-columns: 1fr;
      min-height: 100vh;
    }

    /* Sidebar Navigation */
    .sidebar {
      width: var(--sidebar-width);
      background: #1F2937;
      color: white;
      z-index: 1000;
      height: 100vh;
      overflow-y: auto;
      padding: 20px 10px;
      box-sizing: border-box;
      display: none; /* narrow sidepanelでは隠す */
    }

    /* 幅があるときは左カラム（目次）を出す */
    @media (min-width: 760px) {
      .report-container { grid-template-columns: var(--sidebar-width) minmax(0, 1fr); }
      .sidebar { display: block; position: sticky; top: 0; }
      .main-content { max-width: none; margin: 0; padding: 18px 18px; }
    }

    .main-content {
      padding: 24px 20px;
      width: 100%;
      box-sizing: border-box;
      max-width: 1100px; /* 横幅が広いときのギチギチ対策 */
      margin: 0 auto;
    }

    /* Typography & Components */
    h1 { font-size: 20px; margin: 0 0 4px 0; color: #111; }
    h2 { 
      font-size: 16px; 
      margin: 22px 0 10px 0; 
      border-left: 4px solid var(--accent);
      padding-left: 10px;
      display: flex; align-items: center;
      background: #fff; padding: 8px 10px; border-radius: 4px; /* Card-like header */
    }
    
    .card {
      background: white;
      border-radius: 8px;
      padding: 14px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
      border: 1px solid var(--border);
      margin-bottom: 12px;
    }
    
    .grid-2 { display: grid; grid-template-columns: 1fr; gap: 10px; }
    .grid-3 { display: grid; grid-template-columns: 1fr; gap: 10px; }
    
    @media (min-width: 500px) {
      .grid-2 { grid-template-columns: repeat(2, 1fr); }
      .grid-3 { grid-template-columns: repeat(3, 1fr); }
    }

    .info-item { font-size: 12px; margin-bottom: 6px; line-height: 1.5; color: #374151; }
    .info-label { font-weight: bold; color: #111; display: block; margin-bottom: 2px; }
    
    .score-box {
      font-size: 24px; font-weight: bold; color: var(--accent);
      text-align: center; background: #EFF6FF; padding: 8px; border-radius: 8px;
    }

    .tag {
      display: inline-block; padding: 2px 8px; border-radius: 12px;
      font-size: 11px; margin-right: 4px; background: #E5E7EB; color: #374151;
    }

    /* Print Styles */
    @media print {
      body { background: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      #controls, #loading, .sidebar, #pdf-btn, .fab { display: none !important; }
      .report-container { display: block; } /* Remove flex */
      .main-content { margin: 0 !important; padding: 0 20px !important; width: 100%; box-sizing: border-box; }
      .card { border: 1px solid #ccc; box-shadow: none; break-inside: avoid; margin-bottom: 10px; }
      h2 { page-break-after: avoid; }
      .grid-2, .grid-3 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; } /* Force grid in print */
    }

    button { cursor: pointer; }
    .fab { display: none; } /* Hide FAB in sidepanel default */

    /* Utility */
    .text-sm { font-size: 12px; }
    .text-xs { font-size: 10px; color: #666; }
    .bold { font-weight: bold; }
    
    /* Loading */
    #loading { text-align: center; padding: 20px; display: none; }
    .spinner { border: 3px solid #f3f3f3; border-top: 3px solid var(--accent); border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; margin: 0 auto 10px; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    /* News */
    .news-list { list-style: none; padding: 0; margin: 0; }
    .news-item { padding: 10px 0; border-bottom: 1px solid var(--border); }
    .news-item:last-child { border-bottom: none; }
    .news-link { font-size: 12px; color: var(--accent); text-decoration: none; line-height: 1.4; }
    .news-link:hover { text-decoration: underline; }
    .news-meta { font-size: 10px; color: var(--text-sub); margin-top: 4px; }

    /* Collapsible */
    details.collapsible { padding: 0; }
    details.collapsible > summary {
      list-style: none;
      cursor: pointer;
      padding: 14px 16px;
      font-weight: bold;
      color: var(--text-main);
      background: #F9FAFB;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    details.collapsible > summary::-webkit-details-marker { display: none; }
    details.collapsible > summary::after {
      content: '＋';
      font-size: 14px;
      color: var(--text-sub);
    }
    details.collapsible[open] > summary::after { content: '−'; }
    details.collapsible > .collapsible-body { padding: 0 16px 16px 16px; }
  </style>
</head>
<body>
  <div id="controls">
    <h1>AI Sales OS</h1>
    
    <div class="card" style="margin-bottom: 10px;">
      <div class="info-item" id="page-title">Loading...</div>
      <div class="info-item" style="font-size: 10px; color: #666;" id="page-url">...</div>
    </div>

    <div class="card" style="margin-bottom: 12px;">
      <label for="business-segment" class="info-label">
        🎯 分析対象の事業（任意）
      </label>
      <input type="text" id="business-segment" 
             placeholder="例: BPO事業" 
             style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px; box-sizing: border-box; margin-bottom: 8px;">

      <label for="additional-url" class="info-label">
        🔗 追加参考URL（任意）
      </label>
      <input type="url" id="additional-url" 
             placeholder="例: https://example.com/product/xyz" 
             style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px; box-sizing: border-box;">
    </div>

    <div style="display: flex; gap: 8px;">
      <button id="analyze-btn" style="flex: 3; background: var(--accent); color: white; padding: 10px; border: none; border-radius: 6px; font-weight: bold;">戦略カルテ生成</button>
      <button id="pdf-btn" style="flex: 1; background-color: #6c757d; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">PDF</button>
    </div>
  </div>

  <div id="loading">
    <div class="spinner"></div>
    <p>AI分析中...<br><span style="font-size:10px">財務・ニュース・市場データを統合中</span></p>
  </div>

  <div id="result">
    <div id="content"></div>
  </div>

  <script src="index.js"></script>
</body>
</html>
